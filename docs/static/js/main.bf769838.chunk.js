(this["webpackJsonpjournal-app"]=this["webpackJsonpjournal-app"]||[]).push([[0],{145:function(e,a,t){},146:function(e,a,t){"use strict";t.r(a);var n=t(1),l=t.n(n),r=t(26),o=t.n(r),c=t(6),s=t(16),i=t(5),m=t(22);t(147),t(61);m.a.initializeApp({apiKey:"AIzaSyD1ENCJ-7YrxVPej4Fb9ONyt0hK6x0Ifk0",authDomain:"react-app-curso-c0b6b.firebaseapp.com",projectId:"react-app-curso-c0b6b",storageBucket:"react-app-curso-c0b6b.appspot.com",messagingSenderId:"482078149117",appId:"1:482078149117:web:23836b2a5298339cf0b194"});const u=m.a.firestore(),d=new m.a.auth.GoogleAuthProvider;var p=t(15),E=t.n(p);const h="[auth] Login",b="[auth] Logout",g="[UI] Set Error",_="[UI] Remove Error",y="[UI] Start loading",N="[UI] Finish loading",f="[Notes] New note",w="[Notes] Set active note",v="[Notes] Load notes",j="[Notes] Update note",O="[Notes] Delete note",C="[Notes] Logout Cleaning",k=(e,a)=>({type:w,payload:{id:e,...a}}),S=(e,a)=>({type:f,payload:{id:e,...a}}),x=e=>async a=>{const t=await(async e=>{const a=await u.collection(e+"/journal/notes").get(),t=[];return a.forEach(e=>{t.push({id:e.id,...e.data()})}),t})(e);a(I(t))},I=e=>({type:v,payload:e}),P=e=>async(a,t)=>{const{uid:n}=t().auth;e.url||delete e.url;const l={...e};delete l.id;try{await u.doc(`${n}/journal/notes/${e.id}`).update(l),a(A(e.id,l)),E.a.fire("Saved",e.title,"success")}catch(r){E.a.fire("Error",r.message,"error")}},A=(e,a)=>({type:j,payload:{id:e,note:{id:e,...a}}}),L=e=>async(a,t)=>{const{active:n}=t().notes;E.a.fire({title:"Uploading...",text:"Please wait...",allowOutsideClick:!1,willOpen:()=>{E.a.showLoading()}});const l=await(async e=>{const a=new FormData;a.append("upload_preset","react-journal"),a.append("file",e);try{const e=await fetch("https://api.cloudinary.com/v1_1/dv7wnxdvo/upload",{method:"POST",body:a});if(e.ok){return(await e.json()).secure_url}throw await e.json()}catch(t){throw t}})(e);n.url=l,a(P(n)),E.a.close()},D=e=>({type:O,payload:e}),U=e=>({type:g,payload:e}),F=()=>({type:N}),R=(e,a)=>t=>{t({type:y}),m.a.auth().signInWithEmailAndPassword(e,a).then(({user:e})=>{t($(e.uid,e.displayName)),t(F())}).catch(e=>{console.log(e),t(F()),E.a.fire("Error",e.message,"error")})},$=(e,a)=>({type:h,payload:{uid:e,displayName:a}}),T=()=>async e=>{await m.a.auth().signOut(),e(W()),e({type:C})},W=()=>({type:b}),z=(e={})=>{const[a,t]=Object(n.useState)(e);return[a,({target:e})=>{t({...a,[e.name]:e.value})},(a=e)=>{t(a)}]},G=()=>{const e=Object(c.b)(),{loading:a}=Object(c.c)(e=>e.ui),[t,n]=z({email:"aaa@gmail.com",password:"123456"}),{email:r,password:o}=t;return l.a.createElement(l.a.Fragment,null,l.a.createElement("h3",{className:"auth__title"},"Login"),l.a.createElement("form",{onSubmit:a=>{a.preventDefault(),e(R(r,o))},className:"animate__animated animate__fadeIn animate__faster"},l.a.createElement("input",{type:"text",placeholder:"Email",name:"email",className:"auth__input",autoComplete:"off",value:r,onChange:n}),l.a.createElement("input",{type:"password",placeholder:"Password",name:"password",className:"auth__input",value:o,onChange:n}),l.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block",disabled:a},"Login"),l.a.createElement("div",{className:"auth__social-networks"},l.a.createElement("p",null,"Login with social networks"),l.a.createElement("div",{className:"google-btn",onClick:()=>{e(e=>{m.a.auth().signInWithPopup(d).then(({user:a})=>{e($(a.uid,a.displayName))})})}},l.a.createElement("div",{className:"google-icon-wrapper"},l.a.createElement("img",{className:"google-icon",src:"https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg",alt:"google button"})),l.a.createElement("p",{className:"btn-text"},l.a.createElement("b",null,"Sign in with google")))),l.a.createElement(s.b,{to:"/auth/register",className:"link"},"Create new account")))};var J=t(50),q=t.n(J);const B=()=>{const e=Object(c.b)(),{msgError:a}=Object(c.c)(e=>e.ui);console.log(a);const[t,n]=z({name:"Andres Comun",email:"aaaaa@gmail.com",password:"123456",password2:"123456"}),{name:r,email:o,password:i,password2:u}=t,d=()=>0===r.trim().length?(e(U("Name is required")),!1):q.a.isEmail(o)?i!==u||i.length<5?(e(U("Passwords should match and have a length of 6+ characteres")),!1):(e({type:_}),!0):(e(U("Email is not valid")),!1);return l.a.createElement(l.a.Fragment,null,l.a.createElement("h3",{className:"auth__title"},"Register"),l.a.createElement("form",{onSubmit:a=>{a.preventDefault(),d()&&e(((e,a,t)=>n=>{m.a.auth().createUserWithEmailAndPassword(e,a).then(async({user:e})=>{await e.updateProfile({displayName:t}),n($(e.uid,e.displayName))}).catch(e=>{console.log(e),E.a.fire("Error",e.message,"error")})})(o,i,r))},className:"animate__animated animate__fadeIn animate__faster"},a&&l.a.createElement("div",{className:"auth__alert-error"},a),l.a.createElement("input",{type:"text",placeholder:"Name",name:"name",className:"auth__input",autoComplete:"off",value:r,onChange:n}),l.a.createElement("input",{type:"text",placeholder:"Email",name:"email",className:"auth__input",autoComplete:"off",value:o,onChange:n}),l.a.createElement("input",{type:"password",placeholder:"Password",name:"password",className:"auth__input",value:i,onChange:n}),l.a.createElement("input",{type:"password",placeholder:"Confirm password",name:"password2",className:"auth__input",value:u,onChange:n}),l.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block mb-5"},"Register"),l.a.createElement(s.b,{to:"/auth/login",className:"link"},"Already registered?")))},K=()=>l.a.createElement("div",{className:"auth__main"},l.a.createElement("div",{className:"auth__box-container"},l.a.createElement(i.d,null,l.a.createElement(i.b,{exact:!0,path:"/auth/login",component:G}),l.a.createElement(i.b,{exact:!0,path:"/auth/register",component:B}),l.a.createElement(i.a,{to:"/auth/login"}))));var V=t(28),X=t.n(V);const M=({id:e,date:a,title:t,body:n,url:r})=>{const o=X()(a),s=Object(c.b)();return l.a.createElement("div",{className:"journal__entry pointer animate__animated animate__fadeIn animate__faster",onClick:()=>{console.log("clikc"),s(k(e,{date:a,title:t,body:n,url:r}))}},r&&l.a.createElement("div",{className:"journal__entry-picture",style:{backgroundSize:"cover",backgroundImage:`url(${r})`}}),l.a.createElement("div",{className:"journal__entry-body"},l.a.createElement("p",{className:"journal__entry-title"},t),l.a.createElement("p",{className:"journal__entry-content"},n)),l.a.createElement("div",{className:"journal__entry-date-box"},l.a.createElement("span",null,o.format("dddd")),l.a.createElement("h4",null,o.format("Do"))))},Y=()=>{const{notes:e}=Object(c.c)(e=>e.notes);return console.log(e),l.a.createElement("div",{className:"journal__entries"},e.map(e=>l.a.createElement(M,Object.assign({key:e.id},e))))},H=()=>{const e=Object(c.b)(),{name:a}=Object(c.c)(e=>e.auth);return l.a.createElement("aside",{className:"journal__sidebar"},l.a.createElement("div",{className:"journal__sidebar-navbar"},l.a.createElement("h3",{className:"mt-5"},l.a.createElement("i",{className:"far fa-moon"}),l.a.createElement("span",null," ",a," ")),l.a.createElement("button",{className:"btn",onClick:()=>{e(T())}},"Logout")),l.a.createElement("div",{className:"journal__new-entry",onClick:()=>{e(async(e,a)=>{const{uid:t}=a().auth,n={title:"",body:"",date:(new Date).getTime()},l=await u.collection(t+"/journal/notes").add(n);e(k(l.id,n)),e(S(l.id,n))})}},l.a.createElement("i",{className:"far fa-calendar-plus fa-5x"}),l.a.createElement("p",{className:"mt-5"},"New entry")),l.a.createElement(Y,null))},Q=()=>{const e=Object(c.b)(),{active:a}=Object(c.c)(e=>e.notes),t=X()(a.date);return l.a.createElement("div",{className:"notes__appbar"},l.a.createElement("span",null,t.format("dddd")," ",t.format("Do")),l.a.createElement("input",{id:"fileSelector",type:"file",name:"file",style:{display:"none"},onChange:a=>{const t=a.target.files[0];t&&e(L(t))}}),l.a.createElement("div",null,l.a.createElement("button",{className:"btn",onClick:()=>{document.querySelector("#fileSelector").click()}},"Picture"),l.a.createElement("button",{className:"btn",onClick:()=>{e(P(a))}},"Save")))},Z=()=>{const e=Object(c.b)(),{active:a}=Object(c.c)(e=>e.notes),[t,r,o]=z(a),{body:s,title:i,id:m}=t,d=Object(n.useRef)(a.id);Object(n.useEffect)(()=>{a.id!==d.current&&(o(a),d.current=a.id)},[a,o]),Object(n.useEffect)(()=>{e(k(t.id,{...t}))},[t,e]);return l.a.createElement("div",{className:"notes__main-content"},l.a.createElement(Q,null),l.a.createElement("div",{className:"notes__content"},l.a.createElement("input",{type:"text",placeholder:"Some awesome title",className:"notes__title-input",autoComplete:"off",name:"title",value:i,onChange:r}),l.a.createElement("textarea",{placeholder:"What happened today",className:"notes__textarea",name:"body",value:s,onChange:r}),a.url&&l.a.createElement("div",{className:"notes__image"},l.a.createElement("img",{src:a.url,alt:"imagen"}))),l.a.createElement("button",{className:"btn btn-danger",onClick:()=>{e((e=>async(a,t)=>{const{uid:n}=t().auth;await u.doc(`${n}/journal/notes/${e}`).delete(),a(D(e))})(m))}},"delete"))},ee=()=>l.a.createElement("div",{className:"nothing__main-content"},l.a.createElement("p",null,"Select something",l.a.createElement("br",null),"pr create an entry!"),l.a.createElement("i",{className:"far fa-star fa-4x mt-5"})),ae=()=>{const{active:e}=Object(c.c)(e=>e.notes);return l.a.createElement("div",{className:"journal__main-content animate__animated animate__fadeIn animate__faster"},l.a.createElement(H,null),l.a.createElement("main",null,e?l.a.createElement(Z,null):l.a.createElement(ee,null)))},te=({isAuthenticated:e,component:a,...t})=>l.a.createElement(i.b,Object.assign({},t,{component:t=>e?l.a.createElement(a,t):l.a.createElement(i.a,{to:"/auth/login"})})),ne=({isAuthenticated:e,component:a,...t})=>l.a.createElement(i.b,Object.assign({},t,{component:t=>e?l.a.createElement(i.a,{to:"/"}):l.a.createElement(a,t)})),le=()=>{const e=Object(c.b)(),[a,t]=Object(n.useState)(!0),[r,o]=Object(n.useState)(!1);return Object(n.useEffect)(()=>{m.a.auth().onAuthStateChanged(async a=>{(null===a||void 0===a?void 0:a.uid)?(e($(a.uid,a.displayName)),o(!0),e(x(a.uid))):o(!1),t(!1)})},[e,t]),a?l.a.createElement("h1",null,"Loading ..."):l.a.createElement(s.a,null,l.a.createElement("div",null,l.a.createElement(i.d,null,l.a.createElement(ne,{path:"/auth",component:K,isAuthenticated:r}),l.a.createElement(te,{exact:!0,isAuthenticated:r,path:"/",component:ae}),l.a.createElement(i.a,{to:"/auth/login"}))))};var re=t(23),oe=t(51);const ce={notes:[],active:null},se={loading:!1,msgError:null},ie="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||re.c,me=Object(re.b)({auth:(e={},a)=>{switch(a.type){case h:return{uid:a.payload.uid,name:a.payload.displayName};case b:return{};default:return e}},ui:(e=se,a)=>{switch(a.type){case g:return{...e,msgError:a.payload};case _:return{...e,msgError:null};case y:return{...e,loading:!0};case N:return{...e,loading:!1};default:return e}},notes:(e=ce,a)=>{switch(a.type){case w:return{...e,active:{...a.payload}};case f:return{...e,notes:[a.payload,...e.notes]};case v:return{...e,notes:[...a.payload]};case j:return{...e,notes:e.notes.map(e=>e.id===a.payload.id?a.payload.note:e)};case O:return{...e,active:null,notes:e.notes.filter(e=>e.id!==a.payload)};case C:return{...e,active:null,notes:[]};default:return e}}}),ue=Object(re.d)(me,ie(Object(re.a)(oe.a))),de=()=>l.a.createElement(c.a,{store:ue},l.a.createElement(le,null));t(145);o.a.render(l.a.createElement(de,null),document.getElementById("root"))},52:function(e,a,t){e.exports=t(146)}},[[52,1,2]]]);
//# sourceMappingURL=main.bf769838.chunk.js.map